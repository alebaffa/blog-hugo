<!DOCTYPE html>
<html lang="en-US">
  <head>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114385313-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-114385313-1');
</script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Alessandro Baffa">
    <meta name="description" content="Computer science is no more about computers than astronomy is about telescopes">
    <meta name="generator" content="Hugo 0.35-DEV" />

    
    <title>First try with concurrency in Go &middot; @alebaffa’s Welcome</title>

    <link rel="stylesheet" href="https://alebaffa.com/css/weblog.css" media="screen" charset="utf-8" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.2.14/css/lightgallery.min.css" type="text/css" />
    


    
	<link href="https://alebaffa.com/index.xml" rel="alternate" type="application/rss+xml" title="Welcome" />
	
  </head>
  <body class="site">

<header>
  <nav>
    <h1><a href="/">@alebaffa</a>’s Welcome.</h1>
    <div class="menu">
      
      <ul>
        
            <li>
              <a href="/posts/">Posts</a>
              
                <a href="/posts/index.xml"><img src="/img/rss.svg" class="rss-icon" /></a>
              
            </li>
        
            <li>
              <a href="/projects/">Projects</a>
              
            </li>
        
            <li>
              <a href="/microposts/">Microposts</a>
              
                <a href="/microposts/index.xml"><img src="/img/rss.svg" class="rss-icon" /></a>
              
            </li>
        
        <li><a href="/about">About</a></li>
      </ul>
    </div>
  </nav>
</header>


  <main class="content">
    <article class="page">
      <p>
        <p>It&rsquo;s been a while I&rsquo;m practicing with Go, but I had still never tried its concurrency features so far. My bad.</p>

<p>Fortunately <a href="http://exercism.io">exercism.io</a> has just introduced me to this topic with the exercise <a href="http://exercism.io/exercises/go/parallel-letter-frequency/readme">&ldquo;Parallel Letter Frequency&rdquo; exercise&rdquo;</a>.</p>

<p>The core of my solution is here (I let you read the comments).</p>

<p>Basically the exercise asks you to count the frequency of the letters in 3 different strings. They provide you with already a function that counts the frequency, but you are asked to call that function with 3 calls in parallel (one call for each string) and to collect the result (the total frequencies from all the 3 strings).</p>

<pre><code class="language-go">func Frequency(s string) map[rune]int {
  //DO SOMETHING
}
func ConcurrentFrequency(words []string) map[rune]int {
  // (buffered)channel if type map[run]int with capacity of the lenght of the input (3)
	channel := make(chan map[rune]int, len(words))

	for _, value := range words {
		// anonymous function that calls Frequency() 3 times in parallel
		// and puts the three different results in the channel of capacity 3
		go func(v string){
			channel &lt;- Frequency(v)
		}(value)
	}

  // Now use the values inside the channel.
  frequency := map[rune]int
	// loops 3 times because channel of size 3
	for range words {
		for key, value := range &lt;-channel {
			frequency[key] += value
		}
	}
  return frequency
}
</code></pre>

<p>In this solution I am basically looping over the array of strings in input and call the Frequency() function on every iteration. The interesting thing is here:</p>

<pre><code class="language-go">go func(v string){
  channel &lt;- Frequency(v)
}(value)
</code></pre>

<p>Here I&rsquo;m starting a <strong>goroutine</strong> on an <strong>anonymous function</strong> (the <em>go</em> prefix before <em>func</em>) inside of which I call Frequency(). The Frequency function sends its returned value in a <strong>channel</strong> (of the same type returned from the function). The channel is the way goroutines communicates with each other and so it&rsquo;s also the way to send values back.</p>

<p>Once the channel contains the returned values, you can loop over the channel itself (not sure here if it&rsquo;s because it&rsquo;s a <em>buffered channel</em> and so with a specified capacity or I can do this every time, I still have to understand this).
The channel is of type <em>map[rune]int</em> and so I can fetch <key, value> from it, like so:</p>

<pre><code class="language-go">for range words {
  for key, value := range &lt;-channel {
    frequency[key] += value
  }
}
</code></pre>

<p>Working with channels is very simple and powerful. There are plenty of things that I still have to learn, but this was a good start. <strong>Thanks Exercism.io</strong>!</p>

      </p>
    </article>
  </main>

<footer>
  <div class="footer_text">
      <div>
        <h3>Hi, <a href="/about">I'm Alessandro</a></h3>
        <p>
          Welcome to my blog!
Get in contact with me, drop me an email at <i>contact@alebaffa.com</i>.
        </p>
      </div>
      
      <div>
          <h3><a href="https://www.flickr.com/photos/50161185@N04/">Photo Stream</a></h3>
          <div id="photos"></div>
        </div>
      </div>
      
  </div>

  
    <div class="footer_copyright">
      &copy; 2018 <a href="/about">Alessandro Baffa</a>
       - Made in Tokyo, Japan
    </div>
  
</footer>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/2.2.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.2.14/js/lightgallery-all.min.js" charset="utf-8"></script>
    <script src="/js/weblog.js" charset="utf-8"></script>
    

    <script type="text/javascript">

  
  $(function() {
    
    $.getJSON("https://api.flickr.com/services/feeds/photos_public.gne?id=50161185@N04&format=json&jsoncallback=?", function(data) {
      iweblog.application.displayImages(data, 8);
    });
  });

</script>

    
  </body>
</html>

